\section{Ali\-HLTSystem Class Reference}
\label{classAliHLTSystem}\index{AliHLTSystem@{AliHLTSystem}}
{\tt \#include $<$Ali\-HLTSystem.h$>$}

Inheritance diagram for Ali\-HLTSystem::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classAliHLTSystem}
\end{center}
\end{figure}


\subsection{Detailed Description}
Main class for the HLT integration into Ali\-Root. The class handles a list of configurations. Configurations are translated into task lists which can be executed.

\begin{Desc}
\item[Note:]This class is only used for the {\bf HLT integration into Ali\-Root}{\rm (p.\,\pageref{group__alihlt__system})}. \end{Desc}




Definition at line 43 of file Ali\-HLTSystem.h.\subsection*{Public Types}
\begin{CompactItemize}
\item 
enum {\bf Ali\-HLTSystem\-State\_\-t} \{ \par
{\bf k\-Uninitialized} =  0x0, 
{\bf k\-Libraries\-Loaded} =  0x1, 
{\bf k\-Configuration\-Loaded} =  0x2, 
{\bf k\-Task\-List\-Created} =  0x4, 
\par
{\bf k\-Ready} =  0x7, 
{\bf k\-Running} =  0x8, 
{\bf k\-Error} =  0x1000
 \}
\end{CompactItemize}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
{\bf Ali\-HLTSystem} ()
\item 
{\bf Ali\-HLTSystem} (const {\bf Ali\-HLTSystem} \&)
\item 
{\bf Ali\-HLTSystem} \& {\bf operator=} (const {\bf Ali\-HLTSystem} \&)
\item 
virtual {\bf $\sim$Ali\-HLTSystem} ()
\item 
int {\bf Add\-Configuration} ({\bf Ali\-HLTConfiguration} $\ast$p\-Conf)
\begin{CompactList}\small\item\em transient \item\end{CompactList}\item 
int {\bf Insert\-Configuration} ({\bf Ali\-HLTConfiguration} $\ast$p\-Conf, {\bf Ali\-HLTConfiguration} $\ast$p\-Prec)
\item 
int {\bf Delete\-Configuration} ({\bf Ali\-HLTConfiguration} $\ast$p\-Conf)
\item 
int {\bf Build\-Task\-List} (const char $\ast$p\-Conf)
\item 
int {\bf Build\-Task\-List} ({\bf Ali\-HLTConfiguration} $\ast$p\-Conf)
\item 
int {\bf Clean\-Task\-List} ()
\item 
int {\bf Insert\-Task} ({\bf Ali\-HLTTask} $\ast$p\-Task)
\item 
{\bf Ali\-HLTTask} $\ast$ {\bf Find\-Task} (const char $\ast$id)
\item 
void {\bf Print\-Task\-List} ()
\item 
int {\bf Run} (Int\_\-t i\-Nof\-Events=1)
\item 
int {\bf Init\-Tasks} ()
\item 
int {\bf Init\-Benchmarking} (TObj\-Array $\ast$p\-Stopwatches)
\item 
int {\bf Start\-Tasks} ()
\item 
int {\bf Process\-Tasks} (Int\_\-t event\-No)
\item 
int {\bf Stop\-Tasks} ()
\item 
int {\bf Deinit\-Tasks} ()
\item 
int {\bf Reconstruct} (int nof\-Events, Ali\-Run\-Loader $\ast$run\-Loader, Ali\-Raw\-Reader $\ast$raw\-Reader=NULL)
\item 
int {\bf Fill\-ESD} (int event\-No, Ali\-Run\-Loader $\ast$run\-Loader, Ali\-ESD $\ast$esd)
\item 
int {\bf Load\-Component\-Libraries} (const char $\ast$libs)
\item 
void $\ast$ {\bf Find\-Dynamic\-Symbol} (const char $\ast$library, const char $\ast$symbol)
\item 
int {\bf Configure} (Ali\-Run\-Loader $\ast$runloader=NULL)
\item 
int {\bf Reset} (int b\-Force=0)
\item 
int {\bf Load\-Configurations} (Ali\-Run\-Loader $\ast$runloader=NULL)
\item 
int {\bf Build\-Task\-Lists\-From\-Top\-Configurations} (Ali\-Run\-Loader $\ast$runloader=NULL)
\item 
int {\bf Check\-Status} (int flag)
\item 
int {\bf Get\-Status\-Flags} ()
\end{CompactItemize}
\subsection*{Static Public Member Functions}
\begin{CompactItemize}
\item 
void $\ast$ {\bf Alloc\-Memory} (void $\ast$param, unsigned long size)
\end{CompactItemize}
\subsection*{Public Attributes}
\begin{CompactItemize}
\item 
{\bf Ali\-HLTComponent\-Handler} $\ast$ {\bf fp\-Component\-Handler}
\item 
{\bf Ali\-HLTConfiguration\-Handler} $\ast$ {\bf fp\-Configuration\-Handler}
\begin{CompactList}\small\item\em transient \item\end{CompactList}\end{CompactItemize}
\subsection*{Private Member Functions}
\begin{CompactItemize}
\item 
int {\bf Set\-Status\-Flags} (int flags)
\item 
int {\bf Clear\-Status\-Flags} (int flags)
\item 
{\bf Class\-Def} ({\bf Ali\-HLTSystem}, 2)
\end{CompactItemize}
\subsection*{Private Attributes}
\begin{CompactItemize}
\item 
TList {\bf f\-Task\-List}
\item 
int {\bf f\-State}
\end{CompactItemize}
\subsection*{Static Private Attributes}
\begin{CompactItemize}
\item 
int {\bf fg\-Nof\-Instances} = 0
\end{CompactItemize}


\subsection{Member Enumeration Documentation}
\index{AliHLTSystem@{Ali\-HLTSystem}!AliHLTSystemState_t@{AliHLTSystemState\_\-t}}
\index{AliHLTSystemState_t@{AliHLTSystemState\_\-t}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Ali\-HLTSystem::Ali\-HLTSystem\-State\_\-t}}\label{classAliHLTSystem_w7}


\begin{Desc}
\item[Enumeration values: ]\par
\begin{description}
\index{kUninitialized@{kUninitialized}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kUninitialized@{kUninitialized}}\item[{\em 
k\-Uninitialized\label{classAliHLTSystem_w7w0}
}]\index{kLibrariesLoaded@{kLibrariesLoaded}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kLibrariesLoaded@{kLibrariesLoaded}}\item[{\em 
k\-Libraries\-Loaded\label{classAliHLTSystem_w7w1}
}]\index{kConfigurationLoaded@{kConfigurationLoaded}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kConfigurationLoaded@{kConfigurationLoaded}}\item[{\em 
k\-Configuration\-Loaded\label{classAliHLTSystem_w7w2}
}]\index{kTaskListCreated@{kTaskListCreated}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kTaskListCreated@{kTaskListCreated}}\item[{\em 
k\-Task\-List\-Created\label{classAliHLTSystem_w7w3}
}]\index{kReady@{kReady}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kReady@{kReady}}\item[{\em 
k\-Ready\label{classAliHLTSystem_w7w4}
}]\index{kRunning@{kRunning}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kRunning@{kRunning}}\item[{\em 
k\-Running\label{classAliHLTSystem_w7w5}
}]\index{kError@{kError}!AliHLTSystem@{AliHLTSystem}}\index{AliHLTSystem@{AliHLTSystem}!kError@{kError}}\item[{\em 
k\-Error\label{classAliHLTSystem_w7w6}
}]\end{description}
\end{Desc}



Definition at line 278 of file Ali\-HLTSystem.h.

\footnotesize\begin{verbatim}278                            {
279     kUninitialized       = 0x0,
280     kLibrariesLoaded     = 0x1,
281     kConfigurationLoaded = 0x2,
282     kTaskListCreated     = 0x4,
283     kReady               = 0x7,
284     kRunning             = 0x8,
285     kError               = 0x1000
286   };
\end{verbatim}\normalsize 




\subsection{Constructor \& Destructor Documentation}
\index{AliHLTSystem@{Ali\-HLTSystem}!AliHLTSystem@{AliHLTSystem}}
\index{AliHLTSystem@{AliHLTSystem}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}Ali\-HLTSystem::Ali\-HLTSystem ()}\label{classAliHLTSystem_a0}


default constructor \index{AliHLTSystem@{Ali\-HLTSystem}!AliHLTSystem@{AliHLTSystem}}
\index{AliHLTSystem@{AliHLTSystem}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}Ali\-HLTSystem::Ali\-HLTSystem (const {\bf Ali\-HLTSystem} \&)}\label{classAliHLTSystem_a1}


not a valid copy constructor, defined according to effective C++ style 

Definition at line 87 of file Ali\-HLTSystem.cxx.

References fg\-Nof\-Instances, HLTFatal, and HLTWarning.

\footnotesize\begin{verbatim}88   :
89   AliHLTLogging(),
90   fpComponentHandler(NULL),
91   fpConfigurationHandler(NULL),
92   fTaskList(),
93   fState(0)
94 {
95   // see header file for class documentation
96   if (fgNofInstances++>0)
97     HLTWarning("multiple instances of AliHLTSystem, you should not use more than one at a time");
98 
99   HLTFatal("copy constructor untested");
100 }

\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!~AliHLTSystem@{$\sim$AliHLTSystem}}
\index{~AliHLTSystem@{$\sim$AliHLTSystem}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}Ali\-HLTSystem::$\sim${\bf Ali\-HLTSystem} ()\hspace{0.3cm}{\tt  [virtual]}}\label{classAliHLTSystem_a3}


destructor 

Definition at line 109 of file Ali\-HLTSystem.cxx.

References Clean\-Task\-List(), fg\-Nof\-Instances, fp\-Component\-Handler, fp\-Configuration\-Handler, and Ali\-HLTConfiguration::Global\-Deinit().

\footnotesize\begin{verbatim}110 {
111   // see header file for class documentation
112   fgNofInstances--;
113   CleanTaskList();
114   AliHLTConfiguration::GlobalDeinit(fpConfigurationHandler);
115   if (fpConfigurationHandler) {
116     delete fpConfigurationHandler;
117   }
118   fpConfigurationHandler=NULL;
119   
120   if (fpComponentHandler) {
121     delete fpComponentHandler;
122   }
123   fpComponentHandler=NULL;
124 }
\end{verbatim}\normalsize 




\subsection{Member Function Documentation}
\index{AliHLTSystem@{Ali\-HLTSystem}!AddConfiguration@{AddConfiguration}}
\index{AddConfiguration@{AddConfiguration}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Add\-Configuration ({\bf Ali\-HLTConfiguration} $\ast$ {\em p\-Conf})}\label{classAliHLTSystem_a4}


transient 

Add a configuration to the end of the list. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Conf}]pointer to configuration to add \end{description}
\end{Desc}


Definition at line 128 of file Ali\-HLTSystem.cxx.

\footnotesize\begin{verbatim}129 {
130   // see header file for class documentation
131   int iResult=0;
132   if (pConf) {
133   } else {
134     iResult=-EINVAL;
135   }
136   return iResult;
137 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!AllocMemory@{AllocMemory}}
\index{AllocMemory@{AllocMemory}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void $\ast$ Ali\-HLTSystem::Alloc\-Memory (void $\ast$ {\em param}, unsigned long {\em size})\hspace{0.3cm}{\tt  [static]}}\label{classAliHLTSystem_e0}


The memory allocation function for components. This function is part of the running environment of the components. 

Definition at line 528 of file Ali\-HLTSystem.cxx.

\footnotesize\begin{verbatim}529 {
530   // see header file for class documentation
531   if (param==NULL) {
532     // get rid of 'unused parameter' warning
533   }
534   return (void*)new char[size];
535 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!BuildTaskList@{BuildTaskList}}
\index{BuildTaskList@{BuildTaskList}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Build\-Task\-List ({\bf Ali\-HLTConfiguration} $\ast$ {\em p\-Conf})}\label{classAliHLTSystem_a8}


Build task list from a configuration object. This method is kept for backward compatibility. Use the version with the configuration name. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Conf}]pointer to configuration to build the task list from \end{description}
\end{Desc}


Definition at line 186 of file Ali\-HLTSystem.cxx.

References Build\-Task\-List(), Find\-Task(), Ali\-HLTConfiguration::Follow\-Dependency(), f\-Task\-List, Ali\-HLTTask::Get\-Conf(), Ali\-HLTConfiguration::Get\-First\-Source(), Ali\-HLTTask::Get\-Name(), Ali\-HLTConfiguration::Get\-Name(), Ali\-HLTConfiguration::Get\-Next\-Source(), HLTError, Insert\-Task(), Ali\-HLTTask::Print\-Dependency\-Tree(), and Ali\-HLTConfiguration::Sources\-Resolved().

\footnotesize\begin{verbatim}187 {
188   // see header file for class documentation
189   int iResult=0;
190   if (pConf) {
191     AliHLTTask* pTask=NULL;
192     if ((pTask=FindTask(pConf->GetName()))!=NULL) {
193       if (pTask->GetConf()!=pConf) {
194         HLTError("configuration missmatch, there is already a task with configuration name \"%s\", but it is different. Most likely configuration %p is not registered properly", pConf->GetName(), pConf);
195         iResult=-EEXIST;
196         pTask=NULL;
197       }
198     } else if (pConf->SourcesResolved(1)!=1) {
199         HLTError("configuration \"%s\" has unresolved sources, aborting ...", pConf->GetName());
200         iResult=-ENOLINK;
201     } else {
202       pTask=new AliHLTTask(pConf);
203       if (pTask==NULL) {
204         iResult=-ENOMEM;
205       }
206     }
207     if (pTask) {
208       // check for circular dependencies
209       if ((iResult=pConf->FollowDependency(pConf->GetName()))>0) {
210         HLTError("detected circular dependency for configuration \"%s\"", pTask->GetName());
211         pTask->PrintDependencyTree(pTask->GetName(), 1/*use the configuration list*/);
212         HLTError("aborted ...");
213         iResult=-ELOOP;
214       }
215       if (iResult>=0) {
216         // check whether all dependencies are already in the task list
217         // create the missing ones
218         // this step is an iterative process which calls this function again for the missing
219         // configurations, in order to avoid the currently processed task to be created
220         // again it is added to the list temporarily and removed afterwards
221         // This is of high importance to preserve the order of the tasks. Furthermore, the
222         // InsertTask method has to be used in order to set all the cross links right 
223         fTaskList.Add(pTask);
224         AliHLTConfiguration* pDep=pConf->GetFirstSource();
225         while (pDep!=NULL && iResult>=0) {
226           if (FindTask(pDep->GetName())==NULL) {
227             iResult=BuildTaskList(pDep);
228           }
229           pDep=pConf->GetNextSource();
230         }
231         // remove the temporarily added task
232         fTaskList.Remove(pTask);
233 
234         // insert the task and set the cross-links
235         if (iResult>=0) {
236           iResult=InsertTask(pTask);
237         }
238       } else {
239         delete pTask;
240         pTask=NULL;
241       }
242     }
243   } else {
244     iResult=-EINVAL;
245   }
246   return iResult;
247 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!BuildTaskList@{BuildTaskList}}
\index{BuildTaskList@{BuildTaskList}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Build\-Task\-List (const char $\ast$ {\em p\-Conf})}\label{classAliHLTSystem_a7}


Build a task list This method is used to build the tasks from the 'master' configuration objects which are added to the HLT system handler. This is an iterative process since the task might depend upon other configurations. For each configuration object which has not yet been converted into a task, the method will be called iteratively. Finally, after building all tasks which the current one depends on have been created, the task is inserted to the list of tasks with the Insert\-Task method. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Conf}]configuration name/id \end{description}
\end{Desc}


Definition at line 164 of file Ali\-HLTSystem.cxx.

References Ali\-HLTConfiguration\-Handler::Find\-Configuration(), fp\-Configuration\-Handler, and HLTError.

Referenced by Build\-Task\-List(), and Build\-Task\-Lists\-From\-Top\-Configurations().

\footnotesize\begin{verbatim}165 {
166   // see header file for class documentation
167   int iResult=0;
168   if (id) {
169     if (fpConfigurationHandler) {
170       AliHLTConfiguration* pConf=fpConfigurationHandler->FindConfiguration(id);
171       if (pConf) {
172         iResult=BuildTaskList(pConf);
173       } else {
174         HLTError("unknown configuration \"%s\"", id);
175         iResult=-EEXIST;
176       }
177     } else {
178       iResult=-EFAULT;
179     }
180   } else {
181     iResult=-EINVAL;
182   }
183   return iResult;
184 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!BuildTaskListsFromTopConfigurations@{BuildTaskListsFromTopConfigurations}}
\index{BuildTaskListsFromTopConfigurations@{BuildTaskListsFromTopConfigurations}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Build\-Task\-Lists\-From\-Top\-Configurations (Ali\-Run\-Loader $\ast$ {\em runloader} = {\tt NULL})}\label{classAliHLTSystem_a27}


Get the top configurations of all agents and build the task lists. \begin{Desc}
\item[Returns:]neg. error code if failed \end{Desc}


Definition at line 665 of file Ali\-HLTSystem.cxx.

References Build\-Task\-List(), Check\-Status(), Ali\-HLTConfiguration\-Handler::Find\-Configuration(), fp\-Configuration\-Handler, Ali\-HLTModule\-Agent::Get\-First\-Agent(), Ali\-HLTModule\-Agent::Get\-Local\-Rec\-Configurations(), Ali\-HLTModule\-Agent::Get\-Next\-Agent(), HLTDebug, HLTError, HLTWarning, k\-Configuration\-Loaded, k\-Running, k\-Task\-List\-Created, and Set\-Status\-Flags().

Referenced by Configure().

\footnotesize\begin{verbatim}666 {
667   // see header file for class documentation
668   if (CheckStatus(kRunning)) {
669     HLTError("HLT system in running state, can not configure");
670     return -EBUSY;
671   }
672   if (!CheckStatus(kConfigurationLoaded)) {
673     HLTWarning("configurations not yet loaded");
674     return 0;
675   }
676 
677   int iResult=0;
678   AliHLTModuleAgent* pAgent=AliHLTModuleAgent::GetFirstAgent();
679   while (pAgent && iResult>=0) {
680     TString tops=pAgent->GetLocalRecConfigurations(runloader);
681     HLTDebug("top configurations for agent %s (%p): %s", pAgent->GetName(), pAgent, tops.Data());
682     TObjArray* pTokens=tops.Tokenize(" ");
683     if (pTokens) {
684       int iEntries=pTokens->GetEntries();
685       for (int i=0; i<iEntries && iResult>=0; i++) {
686         const char* pCID=((TObjString*)pTokens->At(i))->GetString().Data();
687         AliHLTConfiguration* pConf=fpConfigurationHandler->FindConfiguration(pCID);
688         if (pConf) {
689           iResult=BuildTaskList(pConf);
690         } else {
691           HLTWarning("can not find top configuration %s", pCID);
692         }
693       }
694       delete pTokens;
695     }
696     
697     pAgent=AliHLTModuleAgent::GetNextAgent();
698   }
699   if (iResult>=0) SetStatusFlags(kTaskListCreated);
700 
701   return iResult;
702 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!CheckStatus@{CheckStatus}}
\index{CheckStatus@{CheckStatus}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Check\-Status (int {\em flag})}\label{classAliHLTSystem_a28}


Check status of the system. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em flag}]Ali\-HLTSystem\-State\_\-t value to check for \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]1 if set, 0 if not \end{Desc}


Definition at line 704 of file Ali\-HLTSystem.cxx.

References f\-State, and k\-Uninitialized.

Referenced by Build\-Task\-Lists\-From\-Top\-Configurations(), Configure(), Load\-Configurations(), Reconstruct(), and Reset().

\footnotesize\begin{verbatim}705 {
706   // see header file for class documentation
707   if (flag==kUninitialized && flag==fState) return 1;
708   if ((fState&flag)==flag) return 1;
709   return 0;
710 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!ClassDef@{ClassDef}}
\index{ClassDef@{ClassDef}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}Ali\-HLTSystem::Class\-Def ({\bf Ali\-HLTSystem}, 2)\hspace{0.3cm}{\tt  [private]}}\label{classAliHLTSystem_d2}


\index{AliHLTSystem@{Ali\-HLTSystem}!CleanTaskList@{CleanTaskList}}
\index{CleanTaskList@{CleanTaskList}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Clean\-Task\-List ()}\label{classAliHLTSystem_a9}


Clean the list of tasks and delete all the task objects. 

Definition at line 249 of file Ali\-HLTSystem.cxx.

References f\-Task\-List.

Referenced by Reset(), and $\sim$Ali\-HLTSystem().

\footnotesize\begin{verbatim}250 {
251   // see header file for class documentation
252   int iResult=0;
253   TObjLink* lnk=NULL;
254   while ((lnk=fTaskList.LastLink())!=NULL) {
255     delete (lnk->GetObject());
256     fTaskList.Remove(lnk);
257   }
258   return iResult;
259 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!ClearStatusFlags@{ClearStatusFlags}}
\index{ClearStatusFlags@{ClearStatusFlags}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Clear\-Status\-Flags (int {\em flags})\hspace{0.3cm}{\tt  [private]}}\label{classAliHLTSystem_d1}


clear status flags. 

Definition at line 725 of file Ali\-HLTSystem.cxx.

References f\-State.

Referenced by Configure(), Load\-Component\-Libraries(), Reset(), and Run().

\footnotesize\begin{verbatim}726 {
727   // see header file for class documentation
728   fState&=~flags;
729   return fState;
730 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!Configure@{Configure}}
\index{Configure@{Configure}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Configure (Ali\-Run\-Loader $\ast$ {\em runloader} = {\tt NULL})}\label{classAliHLTSystem_a24}


Prepare the HLT system for running.\begin{itemize}
\item module agents are requested to register configurations\item task lists are built from the top configurations of the modules \begin{Desc}
\item[Returns:]neg. error code if failed \par
 -EBUSY system is in k\-Running state \par
 \end{Desc}
\end{itemize}


Definition at line 604 of file Ali\-HLTSystem.cxx.

References Build\-Task\-Lists\-From\-Top\-Configurations(), Ali\-HLTLogging::Check\-Filter(), Check\-Status(), Clear\-Status\-Flags(), HLTError, k\-Configuration\-Loaded, k\-Error, k\-HLTLog\-Debug, k\-Running, k\-Task\-List\-Created, Load\-Configurations(), Ali\-HLTModule\-Agent::Print\-Status(), and Set\-Status\-Flags().

\footnotesize\begin{verbatim}605 {
606   // see header file for class documentation
607   int iResult=0;
608   if (CheckStatus(kRunning)) {
609     HLTError("HLT system in running state, can not configure");
610     return -EBUSY;
611   }
612   if (CheckFilter(kHLTLogDebug))
613     AliHLTModuleAgent::PrintStatus();
614   ClearStatusFlags(kConfigurationLoaded|kTaskListCreated);
615   iResult=LoadConfigurations(runloader);
616   if (iResult>=0) {
617     SetStatusFlags(kConfigurationLoaded);
618     iResult=BuildTaskListsFromTopConfigurations(runloader);
619     if (iResult>=0) {
620       SetStatusFlags(kTaskListCreated);
621     }
622   }
623   if (iResult<0) SetStatusFlags(kError);
624   
625   return iResult;
626 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!DeinitTasks@{DeinitTasks}}
\index{DeinitTasks@{DeinitTasks}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Deinit\-Tasks ()}\label{classAliHLTSystem_a19}


De-init all tasks from the list. The {\bf Ali\-HLTTask::Deinit}{\rm (p.\,\pageref{classAliHLTTask_a6})} method is called for each task, the components will be deleted. \begin{Desc}
\item[Returns:]neg error code if failed \end{Desc}


Definition at line 511 of file Ali\-HLTSystem.cxx.

References Ali\-HLTTask::Deinit(), and f\-Task\-List.

Referenced by Run().

\footnotesize\begin{verbatim}512 {
513   // see header file for class documentation
514   int iResult=0;
515   TObjLink *lnk=fTaskList.FirstLink();
516   while (lnk && iResult>=0) {
517     TObject* obj=lnk->GetObject();
518     if (obj) {
519       AliHLTTask* pTask=(AliHLTTask*)obj;
520       iResult=pTask->Deinit();
521     } else {
522     }
523     lnk = lnk->Next();
524   }
525   return iResult;
526 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!DeleteConfiguration@{DeleteConfiguration}}
\index{DeleteConfiguration@{DeleteConfiguration}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Delete\-Configuration ({\bf Ali\-HLTConfiguration} $\ast$ {\em p\-Conf})}\label{classAliHLTSystem_a6}


Remove a configuration from the list. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Conf}]pointer to configuration to delete \end{description}
\end{Desc}


Definition at line 153 of file Ali\-HLTSystem.cxx.

\footnotesize\begin{verbatim}154 {
155   // see header file for class documentation
156   int iResult=0;
157   if (pConf) {
158   } else {
159     iResult=-EINVAL;
160   }
161   return iResult;
162 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!FillESD@{FillESD}}
\index{FillESD@{FillESD}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Fill\-ESD (int {\em event\-No}, Ali\-Run\-Loader $\ast$ {\em run\-Loader}, Ali\-ESD $\ast$ {\em esd})}\label{classAliHLTSystem_a21}


Fill ESD for one event. To be called by the Ali\-HLTReconstructor plugin during the event loop and Fill\-ESD method of the Ali\-Root reconstruction. This method is called on event basis, and thus must copy the previously reconstructed data of the event from the 'ESD' recorder. The Fill\-ESD method of all active Ali\-HLTOffline\-Data\-Sink's is called. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em event\-No}]current event no (Note: this event number is just a processing counter and is not related to the nature/ origin of the event \item[{\em run\-Loader}]the Ali\-Root runloader \item[{\em esd}]an Ali\-ESD instance \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]neg. error code if failed \end{Desc}


Definition at line 558 of file Ali\-HLTSystem.cxx.

References Ali\-HLTOffline\-Interface::Fill\-Component\-ESDs(), HLTError, and HLTInfo.

\footnotesize\begin{verbatim}559 {
560   // see header file for class documentation
561   int iResult=0;
562   if (runLoader) {
563     HLTInfo("Event %d: Run Loader %p, ESD %p", eventNo, runLoader, esd);
564     iResult=AliHLTOfflineInterface::FillComponentESDs(eventNo, runLoader, esd);
565   } else {
566     HLTError("missing run loader/ESD instance(s)");
567     iResult=-EINVAL;
568   }
569   return iResult;
570 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!FindDynamicSymbol@{FindDynamicSymbol}}
\index{FindDynamicSymbol@{FindDynamicSymbol}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void $\ast$ Ali\-HLTSystem::Find\-Dynamic\-Symbol (const char $\ast$ {\em library}, const char $\ast$ {\em symbol})}\label{classAliHLTSystem_a23}


Find a symbol in a dynamically loaded library. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em library}]library \item[{\em symbol}]the symbol to find \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]void pointer to function \end{Desc}


Definition at line 732 of file Ali\-HLTSystem.cxx.

References Ali\-HLTComponent\-Handler::Find\-Symbol(), and fp\-Component\-Handler.

\footnotesize\begin{verbatim}733 {
734   if (fpComponentHandler==NULL) return NULL;
735   return fpComponentHandler->FindSymbol(library, symbol);
736 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!FindTask@{FindTask}}
\index{FindTask@{FindTask}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf Ali\-HLTTask} $\ast$ Ali\-HLTSystem::Find\-Task (const char $\ast$ {\em id})}\label{classAliHLTSystem_a11}


Find a task with an id. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em id}]CONFIGURATION id (not a COMPONENT id!) \end{description}
\end{Desc}


Definition at line 299 of file Ali\-HLTSystem.cxx.

References f\-Task\-List.

Referenced by Build\-Task\-List().

\footnotesize\begin{verbatim}300 {
301   // see header file for class documentation
302   AliHLTTask* pTask=NULL;
303   if (id) {
304     pTask=(AliHLTTask*)fTaskList.FindObject(id); 
305   }
306   return pTask;
307 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!GetStatusFlags@{GetStatusFlags}}
\index{GetStatusFlags@{GetStatusFlags}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Get\-Status\-Flags ()}\label{classAliHLTSystem_a29}


Get the current status. \begin{Desc}
\item[Returns:]status flags of {\bf Ali\-HLTSystem\-State\_\-t}{\rm (p.\,\pageref{classAliHLTSystem_w7})} \end{Desc}


Definition at line 712 of file Ali\-HLTSystem.cxx.

Referenced by Reconstruct().

\footnotesize\begin{verbatim}713 {
714   // see header file for class documentation
715   return fState;
716 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!InitBenchmarking@{InitBenchmarking}}
\index{InitBenchmarking@{InitBenchmarking}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Init\-Benchmarking (TObj\-Array $\ast$ {\em p\-Stopwatches})}\label{classAliHLTSystem_a15}


Init the stopwatches for all tasks. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Stopwatches}]object array of stopwatches, for types \end{description}
\end{Desc}
\begin{Desc}
\item[See also:]{\bf Ali\-HLTComponent::Ali\-HLTStopwatch\-Type}{\rm (p.\,\pageref{classAliHLTComponent_w10})} \end{Desc}
\begin{Desc}
\item[Returns:]neg error code if failed \end{Desc}


Definition at line 406 of file Ali\-HLTSystem.cxx.

References f\-Task\-List, Ali\-HLTTask::Get\-Component(), Ali\-HLTComponent::Get\-Component\-Type(), HLTWarning, Ali\-HLTComponent::Set\-Stopwatch(), and Ali\-HLTComponent::Set\-Stopwatches().

Referenced by Run().

\footnotesize\begin{verbatim}407 {
408   // see header file for class documentation
409   if (pStopwatches==NULL) return -EINVAL;
410 
411   int iResult=0;
412   TObjLink *lnk=fTaskList.FirstLink();
413   while (lnk && iResult>=0) {
414     TObject* obj=lnk->GetObject();
415     if (obj) {
416       AliHLTTask* pTask=(AliHLTTask*)obj;
417       AliHLTComponent* pComp=NULL;
418       if (iResult>=0 && (pComp=pTask->GetComponent())!=NULL) {
419         switch (pComp->GetComponentType()) {
420         case AliHLTComponent::kProcessor:
421           pComp->SetStopwatches(pStopwatches);
422           break;
423         case AliHLTComponent::kSource:
424           {
425             // this switch determines whether the time consumption of the
426             // AliHLTComponent base methods should be counted to the input
427             // stopwatch or base stopwatch.
428             //int inputBase=(int)AliHLTComponent::kSWBase;
429             int inputBase=(int)AliHLTComponent::kSWInput;
430             pComp->SetStopwatch(pStopwatches->At(inputBase), AliHLTComponent::kSWBase);
431             pComp->SetStopwatch(pStopwatches->At((int)AliHLTComponent::kSWInput), AliHLTComponent::kSWDA);
432           }
433           break;
434         case AliHLTComponent::kSink:
435           {
436             // this switch determines whether the time consumption of the
437             // AliHLTComponent base methods should be counted to the output
438             // stopwatch or base stopwatch.
439             //int outputBase=(int)AliHLTComponent::kSWBase;
440             int outputBase=(int)AliHLTComponent::kSWOutput;
441             pComp->SetStopwatch(pStopwatches->At(outputBase), AliHLTComponent::kSWBase);
442             pComp->SetStopwatch(pStopwatches->At((int)AliHLTComponent::kSWOutput), AliHLTComponent::kSWDA);
443           }
444           break;
445         default:
446           HLTWarning("unknown component type %d", (int)pComp->GetComponentType());
447         }
448       }
449     } else {
450     }
451     lnk = lnk->Next();
452   }
453   return iResult;
454 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!InitTasks@{InitTasks}}
\index{InitTasks@{InitTasks}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Init\-Tasks ()}\label{classAliHLTSystem_a14}


Init all tasks from the list. The {\bf Ali\-HLTTask::Init}{\rm (p.\,\pageref{classAliHLTTask_a5})} method is called for each task, the components will be created. \begin{Desc}
\item[Returns:]neg error code if failed \end{Desc}


Definition at line 383 of file Ali\-HLTSystem.cxx.

References fp\-Component\-Handler, f\-Task\-List, HLTWarning, and Ali\-HLTTask::Init().

Referenced by Run().

\footnotesize\begin{verbatim}384 {
385   // see header file for class documentation
386   int iResult=0;
387   TObjLink *lnk=fTaskList.FirstLink();
388   if (lnk==NULL) {
389     HLTWarning("Task list is empty, aborting ...");
390     return -ENOENT;
391   }
392   while (lnk && iResult>=0) {
393     TObject* obj=lnk->GetObject();
394     if (obj) {
395       AliHLTTask* pTask=(AliHLTTask*)obj;
396       iResult=pTask->Init(NULL, fpComponentHandler);
397     } else {
398     }
399     lnk = lnk->Next();
400   }
401   if (iResult<0) {
402   }
403   return iResult;
404 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!InsertConfiguration@{InsertConfiguration}}
\index{InsertConfiguration@{InsertConfiguration}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Insert\-Configuration ({\bf Ali\-HLTConfiguration} $\ast$ {\em p\-Conf}, {\bf Ali\-HLTConfiguration} $\ast$ {\em p\-Prec})}\label{classAliHLTSystem_a5}


Insert a configuration to the end of the list after the specified configuration. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Conf}]pointer to configuration to insert \item[{\em p\-Prec}]pointer to configuration to insert the new one after \end{description}
\end{Desc}


Definition at line 139 of file Ali\-HLTSystem.cxx.

\footnotesize\begin{verbatim}140 {
141   // see header file for class documentation
142   int iResult=0;
143   if (pConf) {
144     if (pPrec) {
145       // find the position
146     }
147   } else {
148     iResult=-EINVAL;
149   }
150   return iResult;
151 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!InsertTask@{InsertTask}}
\index{InsertTask@{InsertTask}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Insert\-Task ({\bf Ali\-HLTTask} $\ast$ {\em p\-Task})}\label{classAliHLTSystem_a10}


Insert a task to the task list. The method first checks whether all dependencies are resolved (i.e. exist already in the task list). During this iteration the cross links between the tasks are set as well. If all dependencies are resolved, the task is added at the end of the list. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\-Task}]pointer to task to add \end{description}
\end{Desc}


Definition at line 261 of file Ali\-HLTSystem.cxx.

References Ali\-HLTTask::Check\-Dependencies(), Ali\-HLTTask::Depends(), f\-Task\-List, Ali\-HLTTask::Get\-Name(), HLTDebug, HLTError, Ali\-HLTTask::Set\-Dependency(), and Ali\-HLTTask::Set\-Target().

Referenced by Build\-Task\-List().

\footnotesize\begin{verbatim}262 {
263   // see header file for class documentation
264   int iResult=0;
265   TObjLink *lnk = NULL;
266   if ((iResult=pTask->CheckDependencies())>0)
267     lnk=fTaskList.FirstLink();
268   while (lnk && iResult>0) {
269     AliHLTTask* pCurr = (AliHLTTask*)lnk->GetObject();
270     //HLTDebug("checking  \"%s\"", pCurr->GetName());
271     iResult=pTask->Depends(pCurr);
272     if (iResult>0) {
273       iResult=pTask->SetDependency(pCurr);
274       pCurr->SetTarget(pTask);
275       HLTDebug("set dependency  \"%s\" for configuration \"%s\"", pCurr->GetName(), pTask->GetName());
276     }
277     if (pCurr->Depends(pTask)) {
278       // circular dependency
279       HLTError("circular dependency: can not resolve dependencies for configuration \"%s\"", pTask->GetName());
280       iResult=-ELOOP;
281     } else if ((iResult=pTask->CheckDependencies())>0) {
282       lnk = lnk->Next();
283     }
284   }
285   if (iResult==0) {
286       if (lnk) {
287         fTaskList.AddAfter(lnk, pTask);
288       } else {
289         fTaskList.AddFirst(pTask);
290       }
291       HLTDebug("task \"%s\" (%p) inserted (size %d)", pTask->GetName(), pTask, sizeof(AliHLTTask));
292   } else if (iResult>0) {
293     HLTError("can not resolve dependencies for configuration \"%s\" (%d unresolved)", pTask->GetName(), iResult);
294     iResult=-ENOLINK;
295   }
296   return iResult;
297 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!LoadComponentLibraries@{LoadComponentLibraries}}
\index{LoadComponentLibraries@{LoadComponentLibraries}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Load\-Component\-Libraries (const char $\ast$ {\em libs})}\label{classAliHLTSystem_a22}


Load component libraries. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em libs}]string of blank separated library names \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]neg. error code if failed \end{Desc}


Definition at line 572 of file Ali\-HLTSystem.cxx.

References Clear\-Status\-Flags(), fp\-Component\-Handler, HLTFatal, k\-Libraries\-Loaded, Ali\-HLTComponent\-Handler::Load\-Library(), and Set\-Status\-Flags().

Referenced by Load\-Configurations().

\footnotesize\begin{verbatim}573 {
574   // see header file for class documentation
575   int iResult=0;
576   if (libraries) {
577     if (fpComponentHandler) {
578       TString libs(libraries);
579       TObjArray* pTokens=libs.Tokenize(" ");
580       if (pTokens) {
581         int iEntries=pTokens->GetEntries();
582         for (int i=0; i<iEntries && iResult>=0; i++) {
583           iResult=fpComponentHandler->LoadLibrary((((TObjString*)pTokens->At(i))->GetString()).Data());
584         }
585         delete pTokens;
586       }
587       if (iResult>=0) {
588         SetStatusFlags(kLibrariesLoaded);
589       } else {
590         // lets see if we need this, probably not
591         //fpComponentHandler->UnloadLibraries();
592         ClearStatusFlags(kLibrariesLoaded);
593       }
594     } else {
595       iResult=-EFAULT;
596       HLTFatal("no component handler available");
597     }
598   } else {
599     iResult=-EINVAL;
600   }
601   return iResult;
602 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!LoadConfigurations@{LoadConfigurations}}
\index{LoadConfigurations@{LoadConfigurations}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Load\-Configurations (Ali\-Run\-Loader $\ast$ {\em runloader} = {\tt NULL})}\label{classAliHLTSystem_a26}


Load the configurations specified by the module agents. The run\-Loader is passed to the agent and allows configuration selection. \begin{Desc}
\item[Returns:]neg. error code if failed \end{Desc}


Definition at line 641 of file Ali\-HLTSystem.cxx.

References Check\-Status(), Ali\-HLTModule\-Agent::Create\-Configurations(), fp\-Configuration\-Handler, Ali\-HLTModule\-Agent::Get\-First\-Agent(), Ali\-HLTModule\-Agent::Get\-Next\-Agent(), Ali\-HLTModule\-Agent::Get\-Required\-Component\-Libraries(), HLTDebug, HLTError, k\-Running, and Load\-Component\-Libraries().

Referenced by Configure().

\footnotesize\begin{verbatim}642 {
643   // see header file for class documentation
644   if (CheckStatus(kRunning)) {
645     HLTError("HLT system in running state, can not configure");
646     return -EBUSY;
647   }
648   int iResult=0;
649   AliHLTModuleAgent* pAgent=AliHLTModuleAgent::GetFirstAgent();
650   while (pAgent && iResult>=0) {
651     const char* deplibs=pAgent->GetRequiredComponentLibraries();
652     if (deplibs) {
653       HLTDebug("load libraries \'%s\' for agent %s (%p)", deplibs, pAgent->GetName(), pAgent);
654       iResult=LoadComponentLibraries(deplibs);
655     }
656     if (iResult>=0) {
657       HLTDebug("load configurations for agent %s (%p)", pAgent->GetName(), pAgent);
658       pAgent->CreateConfigurations(fpConfigurationHandler, runloader);
659       pAgent=AliHLTModuleAgent::GetNextAgent();
660     }
661   }
662   return iResult;
663 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!operator=@{operator=}}
\index{operator=@{operator=}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf Ali\-HLTSystem} \& Ali\-HLTSystem::operator= (const {\bf Ali\-HLTSystem} \&)}\label{classAliHLTSystem_a2}


not a valid assignment op, but defined according to effective C++ style 

Definition at line 102 of file Ali\-HLTSystem.cxx.

References HLTFatal.

\footnotesize\begin{verbatim}103 { 
104   // see header file for class documentation
105   HLTFatal("assignment operator untested");
106   return *this;
107 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!PrintTaskList@{PrintTaskList}}
\index{PrintTaskList@{PrintTaskList}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Ali\-HLTSystem::Print\-Task\-List ()}\label{classAliHLTSystem_a12}


Print the task list. 

Definition at line 309 of file Ali\-HLTSystem.cxx.

References f\-Task\-List, HLTLog\-Keyword, HLTMessage, and Ali\-HLTTask::Print\-Status().

\footnotesize\begin{verbatim}310 {
311   // see header file for class documentation
312   HLTLogKeyword("task list");
313   TObjLink *lnk = NULL;
314   HLTMessage("Task List");
315   lnk=fTaskList.FirstLink();
316   while (lnk) {
317     TObject* obj=lnk->GetObject();
318     if (obj) {
319       HLTMessage("  %s - status:", obj->GetName());
320       AliHLTTask* pTask=(AliHLTTask*)obj;
321       pTask->PrintStatus();
322     } else {
323     }
324     lnk = lnk->Next();
325   }
326 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!ProcessTasks@{ProcessTasks}}
\index{ProcessTasks@{ProcessTasks}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Process\-Tasks (Int\_\-t {\em event\-No})}\label{classAliHLTSystem_a17}


Process task list. The {\bf Ali\-HLTTask::Process\-Task}{\rm (p.\,\pageref{classAliHLTTask_a20})} method is called for each task. \begin{Desc}
\item[Returns:]neg error code if failed \end{Desc}


Definition at line 475 of file Ali\-HLTSystem.cxx.

References f\-Task\-List, Ali\-HLTTask::Get\-Name(), HLTDebug, and Ali\-HLTTask::Process\-Task().

Referenced by Run().

\footnotesize\begin{verbatim}476 {
477   // see header file for class documentation
478   int iResult=0;
479   HLTDebug("processing event no %d", eventNo);
480   TObjLink *lnk=fTaskList.FirstLink();
481   while (lnk && iResult>=0) {
482     TObject* obj=lnk->GetObject();
483     if (obj) {
484       AliHLTTask* pTask=(AliHLTTask*)obj;
485       iResult=pTask->ProcessTask(eventNo);
486       HLTDebug("task %s finnished (%d)", pTask->GetName(), iResult);
487     } else {
488     }
489     lnk = lnk->Next();
490   }
491   return iResult;
492 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!Reconstruct@{Reconstruct}}
\index{Reconstruct@{Reconstruct}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Reconstruct (int {\em nof\-Events}, Ali\-Run\-Loader $\ast$ {\em run\-Loader}, Ali\-Raw\-Reader $\ast$ {\em raw\-Reader} = {\tt NULL})}\label{classAliHLTSystem_a20}


Reconstruction inside Ali\-Root. To be called by the Ali\-HLTReconstructor plugin during the Local\-Reconstruction step of the Ali\-Root reconstruction. The latter means that all events are reconstructed at once, the event loop is internally implemented. In contrast to that, the Fill\-ESD method is called event by event. This requires an 'ESD' recorder at the end of the HLT chain, in order to have the reconstructed events available for the Fill\-ESD loop. The 'run\-Loader' and 'raw\-Reader' parameters are set to all active Ali\-HLTOffline\-Data\-Source's and the HLT chain is processed for the given number of events. If the raw\-Reader is NULL, reconstruction is done on simulated data, from real data if a Raw\-Reader is specified. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em nof\-Events}]number of events \item[{\em run\-Loader}]the Ali\-Root runloader \item[{\em raw\-Reader}]the Ali\-Root Raw\-Reader \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]number of reconstructed events, neg. error code if failed \end{Desc}


Definition at line 537 of file Ali\-HLTSystem.cxx.

References Check\-Status(), Get\-Status\-Flags(), HLTError, HLTInfo, k\-Ready, Run(), and Ali\-HLTOffline\-Interface::Set\-Params\-To\-Components().

\footnotesize\begin{verbatim}539 {
540   // see header file for class documentation
541   int iResult=0;
542   if (runLoader) {
543     HLTInfo("Run Loader %p, Raw Reader %p , %d events", runLoader, rawReader, nofEvents);
544     if (CheckStatus(kReady)) {
545       if ((iResult=AliHLTOfflineInterface::SetParamsToComponents(runLoader, rawReader))>=0) {
546         iResult=Run(nofEvents);
547       }
548     } else {
549       HLTError("wrong state %#x, required flags %#x", GetStatusFlags(), kReady);
550     }
551   } else {
552     HLTError("missing run loader instance");
553     iResult=-EINVAL;
554   }
555   return iResult;
556 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!Reset@{Reset}}
\index{Reset@{Reset}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Reset (int {\em b\-Force} = {\tt 0})}\label{classAliHLTSystem_a25}


Reset the HLT system. Reset is not possible while the system is in running state. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em b\-Force}]force the reset \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]neg. error code if failed \par
 -EBUSY system is in k\-Running state \par
 \end{Desc}


Definition at line 628 of file Ali\-HLTSystem.cxx.

References Check\-Status(), Clean\-Task\-List(), Clear\-Status\-Flags(), HLTError, k\-Running, and k\-Uninitialized.

\footnotesize\begin{verbatim}629 {
630   // see header file for class documentation
631   int iResult=0;
632   if (!bForce && CheckStatus(kRunning)) {
633     HLTError("HLT system in running state, can not configure");
634     return -EBUSY;
635   }
636   CleanTaskList();
637   ClearStatusFlags(~kUninitialized);
638   return iResult;
639 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!Run@{Run}}
\index{Run@{Run}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Run (Int\_\-t {\em i\-Nof\-Events} = {\tt 1})}\label{classAliHLTSystem_a13}


Run the task list. The method checks whether the task list has already been build. If not, or the configuration list has been changed, the {\bf Build\-Task\-List}{\rm (p.\,\pageref{classAliHLTSystem_a7})} method is scalled All tasks of the list will be subsequently processed for each event. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em i\-Nof\-Events}]number of events \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]number of reconstructed events, neg error code if failed \end{Desc}


Definition at line 328 of file Ali\-HLTSystem.cxx.

References Clear\-Status\-Flags(), Deinit\-Tasks(), HLTError, HLTInfo, Init\-Benchmarking(), Init\-Tasks(), k\-Running, Process\-Tasks(), Set\-Status\-Flags(), Start\-Tasks(), and Stop\-Tasks().

Referenced by Reconstruct().

\footnotesize\begin{verbatim}329 {
330   // see header file for class documentation
331   int iResult=0;
332   int iCount=0;
333   SetStatusFlags(kRunning);
334   TStopwatch StopwatchBase; StopwatchBase.Reset();
335   TStopwatch StopwatchDA; StopwatchDA.Reset();
336   TStopwatch StopwatchInput; StopwatchInput.Reset();
337   TStopwatch StopwatchOutput; StopwatchOutput.Reset();
338   TObjArray Stopwatches;
339   Stopwatches.AddAt(&StopwatchBase, (int)AliHLTComponent::kSWBase);
340   Stopwatches.AddAt(&StopwatchDA, (int)AliHLTComponent::kSWDA);
341   Stopwatches.AddAt(&StopwatchInput, (int)AliHLTComponent::kSWInput);
342   Stopwatches.AddAt(&StopwatchOutput, (int)AliHLTComponent::kSWOutput);
343   if ((iResult=InitTasks())>=0 && (iResult=InitBenchmarking(&Stopwatches))>=0) {
344     if ((iResult=StartTasks())>=0) {
345       for (int i=0; i<iNofEvents && iResult>=0; i++) {
346         iResult=ProcessTasks(i);
347         if (iResult>=0) {
348           HLTInfo("Event %d successfully finished (%d)", i, iResult);
349           iResult=0;
350           iCount++;
351         } else {
352           HLTError("Processing of event %d failed (%d)", i, iResult);
353           // TODO: define different running modes to either ignore errors in
354           // event processing or not
355           // currently ignored 
356           //iResult=0;
357         }
358       }
359       StopTasks();
360     } else {
361       HLTError("can not start task list");
362     }
363     DeinitTasks();
364   } else if (iResult!=-ENOENT) {
365     HLTError("can not initialize task list");
366   }
367   if (iResult>=0) {
368     iResult=iCount;
369     HLTInfo("HLT statistics:\n"
370             "    base:              R:%.3fs C:%.3fs\n"
371             "    input:             R:%.3fs C:%.3fs\n"
372             "    output:            R:%.3fs C:%.3fs\n"
373             "    event processing : R:%.3fs C:%.3fs"
374             , StopwatchBase.RealTime(),StopwatchBase.CpuTime()
375             , StopwatchInput.RealTime(),StopwatchInput.CpuTime()
376             , StopwatchOutput.RealTime(),StopwatchOutput.CpuTime()
377             , StopwatchDA.RealTime(),StopwatchDA.CpuTime());
378   }
379   ClearStatusFlags(kRunning);
380   return iResult;
381 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!SetStatusFlags@{SetStatusFlags}}
\index{SetStatusFlags@{SetStatusFlags}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Set\-Status\-Flags (int {\em flags})\hspace{0.3cm}{\tt  [private]}}\label{classAliHLTSystem_d0}


Set status flags. 

Definition at line 718 of file Ali\-HLTSystem.cxx.

References f\-State.

Referenced by Build\-Task\-Lists\-From\-Top\-Configurations(), Configure(), Load\-Component\-Libraries(), and Run().

\footnotesize\begin{verbatim}719 {
720   // see header file for class documentation
721   fState|=flags;
722   return fState;
723 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!StartTasks@{StartTasks}}
\index{StartTasks@{StartTasks}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Start\-Tasks ()}\label{classAliHLTSystem_a16}


Start task list. The {\bf Ali\-HLTTask::Start\-Run}{\rm (p.\,\pageref{classAliHLTTask_a18})} method is called for each task, the components will be prepared for event processing. \begin{Desc}
\item[Returns:]neg error code if failed \end{Desc}


Definition at line 456 of file Ali\-HLTSystem.cxx.

References f\-Task\-List, and Ali\-HLTTask::Start\-Run().

Referenced by Run().

\footnotesize\begin{verbatim}457 {
458   // see header file for class documentation
459   int iResult=0;
460   TObjLink *lnk=fTaskList.FirstLink();
461   while (lnk && iResult>=0) {
462     TObject* obj=lnk->GetObject();
463     if (obj) {
464       AliHLTTask* pTask=(AliHLTTask*)obj;
465       iResult=pTask->StartRun();
466     } else {
467     }
468     lnk = lnk->Next();
469   }
470   if (iResult<0) {
471   }
472   return iResult;
473 }
\end{verbatim}\normalsize 


\index{AliHLTSystem@{Ali\-HLTSystem}!StopTasks@{StopTasks}}
\index{StopTasks@{StopTasks}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int Ali\-HLTSystem::Stop\-Tasks ()}\label{classAliHLTSystem_a18}


Stop task list. The {\bf Ali\-HLTTask::End\-Run}{\rm (p.\,\pageref{classAliHLTTask_a19})} method is called for each task, the components will be cleaned after event processing. \begin{Desc}
\item[Returns:]neg error code if failed \end{Desc}


Definition at line 494 of file Ali\-HLTSystem.cxx.

References Ali\-HLTTask::End\-Run(), and f\-Task\-List.

Referenced by Run().

\footnotesize\begin{verbatim}495 {
496   // see header file for class documentation
497   int iResult=0;
498   TObjLink *lnk=fTaskList.FirstLink();
499   while (lnk && iResult>=0) {
500     TObject* obj=lnk->GetObject();
501     if (obj) {
502       AliHLTTask* pTask=(AliHLTTask*)obj;
503       iResult=pTask->EndRun();
504     } else {
505     }
506     lnk = lnk->Next();
507   }
508   return iResult;
509 }
\end{verbatim}\normalsize 




\subsection{Member Data Documentation}
\index{AliHLTSystem@{Ali\-HLTSystem}!fgNofInstances@{fgNofInstances}}
\index{fgNofInstances@{fgNofInstances}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int {\bf Ali\-HLTSystem::fg\-Nof\-Instances} = 0\hspace{0.3cm}{\tt  [static, private]}}\label{classAliHLTSystem_v0}


the number of instances of Ali\-HLTSystem 

Definition at line 126 of file Ali\-HLTSystem.cxx.

Referenced by Ali\-HLTSystem(), and $\sim$Ali\-HLTSystem().\index{AliHLTSystem@{Ali\-HLTSystem}!fpComponentHandler@{fpComponentHandler}}
\index{fpComponentHandler@{fpComponentHandler}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf Ali\-HLTComponent\-Handler}$\ast$ {\bf Ali\-HLTSystem::fp\-Component\-Handler}}\label{classAliHLTSystem_o0}


Pointer to an instance of {\bf Ali\-HLTComponent\-Handler}{\rm (p.\,\pageref{classAliHLTComponentHandler})}. 

Definition at line 57 of file Ali\-HLTSystem.h.

Referenced by Find\-Dynamic\-Symbol(), Init\-Tasks(), Load\-Component\-Libraries(), and $\sim$Ali\-HLTSystem().\index{AliHLTSystem@{Ali\-HLTSystem}!fpConfigurationHandler@{fpConfigurationHandler}}
\index{fpConfigurationHandler@{fpConfigurationHandler}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf Ali\-HLTConfiguration\-Handler}$\ast$ {\bf Ali\-HLTSystem::fp\-Configuration\-Handler}}\label{classAliHLTSystem_o1}


transient 

Pointer to an instance of {\bf Ali\-HLTConfiguration\-Handler}{\rm (p.\,\pageref{classAliHLTConfigurationHandler})}. 

Definition at line 62 of file Ali\-HLTSystem.h.

Referenced by Build\-Task\-List(), Build\-Task\-Lists\-From\-Top\-Configurations(), Load\-Configurations(), and $\sim$Ali\-HLTSystem().\index{AliHLTSystem@{Ali\-HLTSystem}!fState@{fState}}
\index{fState@{fState}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int {\bf Ali\-HLTSystem::f\-State}\hspace{0.3cm}{\tt  [private]}}\label{classAliHLTSystem_r1}


state of the object 

Definition at line 324 of file Ali\-HLTSystem.h.

Referenced by Check\-Status(), Clear\-Status\-Flags(), and Set\-Status\-Flags().\index{AliHLTSystem@{Ali\-HLTSystem}!fTaskList@{fTaskList}}
\index{fTaskList@{fTaskList}!AliHLTSystem@{Ali\-HLTSystem}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}TList {\bf Ali\-HLTSystem::f\-Task\-List}\hspace{0.3cm}{\tt  [private]}}\label{classAliHLTSystem_r0}


list of tasks 

Definition at line 318 of file Ali\-HLTSystem.h.

Referenced by Build\-Task\-List(), Clean\-Task\-List(), Deinit\-Tasks(), Find\-Task(), Init\-Benchmarking(), Init\-Tasks(), Insert\-Task(), Print\-Task\-List(), Process\-Tasks(), Start\-Tasks(), and Stop\-Tasks().

The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
/home/perthi/cern/aliroot/Ali\-Root\_\-head020507/HLT/BASE/{\bf Ali\-HLTSystem.h}\item 
/home/perthi/cern/aliroot/Ali\-Root\_\-head020507/HLT/BASE/{\bf Ali\-HLTSystem.cxx}\end{CompactItemize}
